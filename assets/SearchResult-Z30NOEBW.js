import{u as $,g as te,h as le,i as I,j as se,P as ae,t as re,k as ie,l as P,m as C,n as oe,p as U,q as l,s as ue,R as j,v as ne,x as ce,y as he,C as ve,z as de,A as pe,B as ye,D as me,E as ge,F as fe,G as Le,H as F,I as K,J as Re,K as w,L as Me}from"./app-D5W2byDe.js";const He=["/","/intro.html","/traffic/CA.html","/traffic/ns.html","/traffic/pedestrian.html","/ML/Basic%20Knowledge/attention.html","/ML/Basic%20Knowledge/convolution.html","/ML/Basic%20Knowledge/document.html","/ML/Basic%20Knowledge/question.html","/ML/Model/gnn.html","/ML/RL/B.html","/ML/RL/C1.html","/ML/RL/C2.html","/ML/RL/C3.html","/ML/RL/C4.html","/ML/RL/C5.html","/ML/RL/C6.html","/ML/RL/C7.html","/daily/english/tec_1.html","/daily/english/vocabulary.html","/daily/guitar/jiezou.html","/daily/guitar/pu.html","/daily/guitar/yinjie.html","/daily/guitar/yinxiuzhifu.html","/robotics/Moden%20Robotics/back.html","/robotics/Moden%20Robotics/content.html","/robotics/Planning%20Algorithm/chapter1.html","/robotics/Planning%20Algorithm/chapter2.html","/robotics/paper/TC-CBS-t.html","/robotics/paper/iMTSP.html","/ML/Model/Diffusion/diffusion_1.html","/ML/Model/Diffusion/diffusion_2.html","/ML/Model/Diffusion/diffusion_start.html","/404.html","/traffic/","/ML/Basic%20Knowledge/","/ML/","/ML/Model/","/ML/RL/","/daily/english/","/daily/","/daily/guitar/","/robotics/Moden%20Robotics/","/robotics/","/robotics/Planning%20Algorithm/","/robotics/paper/","/ML/Model/Diffusion/","/category/","/category/%E4%BA%A4%E9%80%9A/","/category/ml/","/category/rl/","/category/gt/","/category/robot/","/category/pr/","/tag/","/tag/traffic/","/article/","/star/","/timeline/"],be="SEARCH_PRO_QUERY_HISTORY",g=$(be,[]),Ce=()=>{const{queryHistoryCount:s}=w,a=s>0;return{enabled:a,queryHistory:g,addQueryHistory:r=>{a&&(g.value=Array.from(new Set([r,...g.value.slice(0,s-1)])))},removeQueryHistory:r=>{g.value=[...g.value.slice(0,r),...g.value.slice(r+1)]}}},B=s=>He[s.id]+("anchor"in s?`#${s.anchor}`:""),we="SEARCH_PRO_RESULT_HISTORY",{resultHistoryCount:O}=w,f=$(we,[]),ke=()=>{const s=O>0;return{enabled:s,resultHistory:f,addResultHistory:a=>{if(s){const r={link:B(a),display:a.display};"header"in a&&(r.header=a.header),f.value=[r,...f.value.slice(0,O-1)]}},removeResultHistory:a=>{f.value=[...f.value.slice(0,a),...f.value.slice(a+1)]}}},Qe=s=>{const a=ve(),r=I(),k=de(),o=P(0),M=C(()=>o.value>0),p=pe([]);return ye(()=>{const{search:y,terminate:Q}=me(),L=Re(c=>{const R=c.join(" "),{searchFilter:q=d=>d,splitWord:x,suggestionsFilter:E,...m}=a.value;R?(o.value+=1,y(c.join(" "),r.value,m).then(d=>q(d,R,r.value,k.value)).then(d=>{o.value-=1,p.value=d}).catch(d=>{console.warn(d),o.value-=1,o.value||(p.value=[])})):p.value=[]},w.searchDelay-w.suggestDelay);U([s,r],([c])=>L(c),{immediate:!0}),ge(()=>{Q()})}),{isSearching:M,results:p}};var xe=te({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(s,{emit:a}){const r=le(),k=I(),o=se(ae),{enabled:M,addQueryHistory:p,queryHistory:y,removeQueryHistory:Q}=Ce(),{enabled:L,resultHistory:c,addResultHistory:R,removeResultHistory:q}=ke(),x=M||L,E=re(s,"queries"),{results:m,isSearching:d}=Qe(E),i=ie({isQuery:!0,index:0}),h=P(0),v=P(0),_=C(()=>x&&(y.value.length>0||c.value.length>0)),A=C(()=>m.value.length>0),S=C(()=>m.value[h.value]||null),z=()=>{const{isQuery:e,index:t}=i;t===0?(i.isQuery=!e,i.index=e?c.value.length-1:y.value.length-1):i.index=t-1},Y=()=>{const{isQuery:e,index:t}=i;t===(e?y.value.length-1:c.value.length-1)?(i.isQuery=!e,i.index=0):i.index=t+1},G=()=>{h.value=h.value>0?h.value-1:m.value.length-1,v.value=S.value.contents.length-1},J=()=>{h.value=h.value<m.value.length-1?h.value+1:0,v.value=0},V=()=>{v.value<S.value.contents.length-1?v.value+=1:J()},N=()=>{v.value>0?v.value-=1:G()},D=e=>e.map(t=>Me(t)?t:l(t[0],t[1])),W=e=>{if(e.type==="customField"){const t=fe[e.index]||"$content",[u,b=""]=Le(t)?t[k.value].split("$content"):t.split("$content");return e.display.map(n=>l("div",D([u,...n,b])))}return e.display.map(t=>l("div",D(t)))},H=()=>{h.value=0,v.value=0,a("updateQuery",""),a("close")},X=()=>M?l("ul",{class:"search-pro-result-list"},l("li",{class:"search-pro-result-list-item"},[l("div",{class:"search-pro-result-title"},o.value.queryHistory),y.value.map((e,t)=>l("div",{class:["search-pro-result-item",{active:i.isQuery&&i.index===t}],onClick:()=>{a("updateQuery",e)}},[l(F,{class:"search-pro-result-type"}),l("div",{class:"search-pro-result-content"},e),l("button",{class:"search-pro-remove-icon",innerHTML:K,onClick:u=>{u.preventDefault(),u.stopPropagation(),Q(t)}})]))])):null,Z=()=>L?l("ul",{class:"search-pro-result-list"},l("li",{class:"search-pro-result-list-item"},[l("div",{class:"search-pro-result-title"},o.value.resultHistory),c.value.map((e,t)=>l(j,{to:e.link,class:["search-pro-result-item",{active:!i.isQuery&&i.index===t}],onClick:()=>{H()}},()=>[l(F,{class:"search-pro-result-type"}),l("div",{class:"search-pro-result-content"},[e.header?l("div",{class:"content-header"},e.header):null,l("div",e.display.map(u=>D(u)).flat())]),l("button",{class:"search-pro-remove-icon",innerHTML:K,onClick:u=>{u.preventDefault(),u.stopPropagation(),q(t)}})]))])):null;return oe("keydown",e=>{if(s.isFocusing){if(A.value){if(e.key==="ArrowUp")N();else if(e.key==="ArrowDown")V();else if(e.key==="Enter"){const t=S.value.contents[v.value];p(s.queries.join(" ")),R(t),r.push(B(t)),H()}}else if(L){if(e.key==="ArrowUp")z();else if(e.key==="ArrowDown")Y();else if(e.key==="Enter"){const{index:t}=i;i.isQuery?(a("updateQuery",y.value[t]),e.preventDefault()):(r.push(c.value[t].link),H())}}}}),U([h,v],()=>{var e;(e=document.querySelector(".search-pro-result-list-item.active .search-pro-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>l("div",{class:["search-pro-result-wrapper",{empty:s.queries.length?!A.value:!_.value}],id:"search-pro-results"},s.queries.length?d.value?l(ue,{hint:o.value.searching}):A.value?l("ul",{class:"search-pro-result-list"},m.value.map(({title:e,contents:t},u)=>{const b=h.value===u;return l("li",{class:["search-pro-result-list-item",{active:b}]},[l("div",{class:"search-pro-result-title"},e||o.value.defaultTitle),t.map((n,ee)=>{const T=b&&v.value===ee;return l(j,{to:B(n),class:["search-pro-result-item",{active:T,"aria-selected":T}],onClick:()=>{p(s.queries.join(" ")),R(n),H()}},()=>[n.type==="text"?null:l(n.type==="title"?ne:n.type==="heading"?ce:he,{class:"search-pro-result-type"}),l("div",{class:"search-pro-result-content"},[n.type==="text"&&n.header?l("div",{class:"content-header"},n.header):null,l("div",W(n))])])})])})):o.value.emptyResult:x?_.value?[X(),Z()]:o.value.emptyHistory:o.value.emptyResult)}});export{xe as default};
